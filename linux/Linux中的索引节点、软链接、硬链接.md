**什么是索引节点**
什么是硬链接
什么是软链接



软链接应用之：灵活切换不同版本的目标程序
软链接应用之：动态库版本管理
软链接应用之：快捷方式

硬链接之应用：从不同角度对文件进行分类
硬链接应用之：文件多人共享
硬链接之应用：文件备份

## 索引节点

文件和索引节点 inode



在 Linux 系统中，我们可以把一个文件看做 3 个组成部分：

文件名：从用户角度来描述一个文件；

文件内容：也就是文件中存储的那些数据；

文件的描述信息：文件的类型、所有者、创建时间等等，可以称之为元信息；



文件的所有信息都需要存储在硬盘上，因此就要对硬盘进行区域划分：不同的区域存储不同类型的数据，这就是文件系统的重要作用。

在 Linux 系统使用的 ext2／ext3 文件系统中，从硬盘上划分一块区域，用来存放文件本身的内容（数据），这块区域按照一个最小单位：块（block）来进行划分。

然后从硬盘上划分出另一块区域，专门用来存放所有文件的描述信息。

每一个文件的描述信息，都用一个名为索引节点（inode）的数据结构来表示，所有文件的 inode 就统一放在这块硬盘区域中。



一个文件的索引节点（inode）中，也记录了这个文件的所有描述信息，包括：文件类型、所有者、创建时间等待，当然也包括文件内容存储在硬盘的哪些块（block）中。



## **硬链接**

每一个文件都对应一个 inode 节点。

例如有一个文件 a．txt，文件内容长度是 1024 个字节，存放在硬盘上的某个块（block）中，假设就是第 10000 个块吧。

那么这个文件对应的 inode 节点中，就会把 10000 这个块记录下来。

同时，它还有一个 links 字段，表示：当前这个 inode 对应一个文件，此时 inode．links 的值为 1。

### 创建

此时，如果我们**用另一个文件名 a＿hard＿link.txt**，也来**表示 a.txt 这个文件**。

虽然我们用了 **2 个文件名称**，但是**本质上指向同一个文件**，内容都指向第 10000 个块中存储的文件内容。

Linux 系统中提供了硬链接来支持这样的目的，它仅仅是把 inode 节点中的 links 字段的值 加1 即可，也就是 inode．links 的值变成了 2。

硬链接的操作指令是：

```
 ln a.txt b.txt
```

### 删除

**硬链接的文件，在删除后该文件对应的 inode 中的 links 值减1，操作系统发现不为 0，因此并不会删掉这个 inode。**



### **硬链接缺点：**

- 不允许用户给目录创建硬链接，即：用户不可以，操作系统可以（想一下每个目录下的 ． 和 ．．）；

- 只有在同一个文件系统中的文件，才能创建硬链接，也就是说：不能跨文件系统；

## **软链接**

为了克服硬链接的 2 个限制，软链接被引入进来了。

软链接也叫符号链接，它是一个独立的文件。

软链接文件的内容是一个文本字符串，存储的是**目标文件（即：链接到的文件）的路径名**。

这个路径名可以指向任意一个文件系统的任意文件或者目录，甚至可以指向一个不存在的文件。

与创建硬链接不同的是：当我们创建了一个软链接之后，操作系统会创建一个新的 inode 来表示这个软链接文件。

### 创建

例如有一个文件 a．txt，我们创建一个软链接 a＿soft＿link．txt 来指向它：

`＄ ln －s a.txt a＿soft＿link.txt`

此时，a．txt 和 a＿soft＿link．txt 各自都有自己的 inode 节点。



当我们打开文件软链接 a＿soft＿link．txt 时，操作系统从 a＿soft＿link．txt 对应的 inode 数据结构中发现：这是一个软链接文件。

于是操作系统就根据其中的路径信息，找到 a．txt 的 inode 节点，从而对最终的目标文件进行操作。

### 删除操作

如果我们把目标文件 a．txt 删除掉之后，inode 节点会被删除掉

此时再次打开软链接 a＿soft＿link．txt 时，虽然其中的路径信息仍然存在，但是系统此时却找不到 a．txt 对应的 inode 节点了。

因此，软链接就类似于与 Windows 系统中的快捷方式。

当真正的目标文件被删除之后，快捷方式也就没有存在的意义了。